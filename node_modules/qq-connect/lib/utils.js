var crypto = require('crypto');
var createUid = function(len) {
	len || (len = 32);
  return crypto.randomBytes(Math.ceil(len * 3 / 4)).toString('base64').slice(0, len);
};
var createMd5 = function(str, encoding){
  return crypto
    .createHash('md5')
    .update(str)
    .digest(encoding || 'hex');
};
var createState = function() {
	return createMd5(createUid());
};
var createSessionid = function() {
	return createMd5(createUid(24));
};
exports = module.exports = {
	createSessionid: createSessionid,
	createState: createState
};